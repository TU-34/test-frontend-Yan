var googletag = googletag || {};
(googletag.cmd = googletag.cmd || []),
  (window.IOLMetrics = window.IOLMetrics || []),
  (window.IOLMetricsTrack =
    window.IOLMetricsTrack ||
    function (e, o, n, t, i, a) {
      try {
        void 0 === o && (o = !1),
          !1 === o && (o = Date.now()),
          window.IOLMetrics.push([e, o, n, t, i, a]);
      } catch (e) {}
    });
var advSlots = new Array();
function trackADVPerformance() {
  googletag.cmd.push(function () {
    googletag.pubads().addEventListener("slotRenderEnded", function (e) {
      try {
        var o = e.slot.getSlotElementId(),
          n = {};
        (n.id = o),
          (n.size = null != e.size ? e.size[0] + "x" + e.size[1] : "empty"),
          advSlots.push(n);
      } catch (e) {
        console.log("error tracking performance in slotRenderEnded" + e);
      }
      scriptsToBeDelayed();
    }),
      googletag.pubads().addEventListener("impressionViewable", function (e) {
        try {
          var o = e.slot.getSlotElementId();
          advSlots.find(function (e) {
            return e.id === o;
          });
        } catch (e) {
          console.log("error tracking performance in impressionViewable" + e);
        }
      }),
      googletag.pubads().addEventListener("slotOnload", function (e) {
        try {
          var o = e.slot.getSlotElementId();
          advSlots.find(function (e) {
            return e.id === o;
          });
        } catch (e) {
          console.log("error tracking performance in slotOnload" + e);
        }
      });
  });
}
function trackPerfContent20() {
  (window.IOLMetricsConf = {
    sample: 50,
    domain: "wwwtest.virgilio.it",
    testab: _ABTestingTrack,
    basic: !0,
    extended: !0,
    adv: !0,
    slots: [
      "admputop",
      "adwallpaper",
      "admasthead",
      "admpumiddle",
      "adoutofpage",
    ],
    visibility: !0,
    max: 12e4,
    grouped: 6,
    groupTimeout: 1e3,
    pageid: "hp",
  }),
    setTimeout(function () {
      var e = document.createElement("script");
      (e.src = _PUB_PATH + "/js/track20_8.min.js?" + _HPJS_NOCACHE),
        document.getElementsByTagName("body")[0].appendChild(e);
    }, 100);
}
!(function (e) {
  if ((void 0 === e.IOL && (e.IOL = {}), void 0 === IOL.cmp)) {
    (IOL.cmp = {}),
      (IOL.cmp.iubenda = null),
      (IOL.cmp.tcf = null),
      (IOL.cmp.both = null),
      void 0 === IOL.cmp.callbacks && (IOL.cmp.callbacks = []);
    var o = function () {
      if (null !== IOL.cmp.iubenda && null !== IOL.cmp.tcf) {
        (IOL.cmp.both = IOL.cmp.iubenda && IOL.cmp.tcf),
          console.log(
            "*** CMP CALLBACK",
            IOL.cmp.iubenda,
            IOL.cmp.tcf,
            IOL.cmp.callbacks.length
          );
        for (var e = 0; e < IOL.cmp.callbacks.length; e++)
          IOL.cmp.callbacks[e](IOL.cmp.both, IOL.cmp.iubenda, IOL.cmp.tcf);
        IOL.cmp.callbacks.push = function (e) {
          e(IOL.cmp.both, IOL.cmp.iubenda, IOL.cmp.tcf);
        };
      }
    };
    "undefined" != typeof _iolconsent &&
      void 0 !== _iolconsent.callbacks &&
      _iolconsent.callbacks.push(function () {
        if (null === IOL.cmp.iubenda) {
          var e = !0;
          if (
            void 0 !== _iolconsent.data &&
            void 0 !== _iolconsent.data.purposes
          ) {
            for (var n = 1; n <= 5; n++)
              if (2 !== n) {
                var t = !1;
                if (
                  (void 0 !== _iolconsent.data.purposes[n] &&
                    (t = _iolconsent.data.purposes[n]),
                  !t)
                ) {
                  e = !1;
                  break;
                }
              }
          } else e = !1;
          (IOL.cmp.iubenda = e), o();
        }
      }),
      void 0 !== e.__tcfapi &&
        e.__tcfapi("addEventListener", 2, function (e, n) {
          if (null === IOL.cmp.tcf) {
            var t = !0;
            if (
              void 0 !== e &&
              void 0 !== e.purpose &&
              void 0 !== e.purpose.consents
            )
              for (var i = 1; i <= 10; i++) {
                var a = !1;
                if (
                  (void 0 !== e.purpose.consents[i] &&
                    (a = e.purpose.consents[i]),
                  !a)
                ) {
                  t = !1;
                  break;
                }
              }
            else t = !1;
            if (t)
              if (void 0 !== e && void 0 !== e.specialFeatureOptins)
                for (i = 1; i <= 2; i++) {
                  a = !1;
                  if (
                    (void 0 !== e.specialFeatureOptins[i] &&
                      (a = e.specialFeatureOptins[i]),
                    !a)
                  ) {
                    t = !1;
                    break;
                  }
                }
              else t = !1;
            (IOL.cmp.tcf = t), o();
          }
        });
  }
})(window),
  (function (e) {
    if (
      (void 0 === e.IOLHP && (e.IOLHP = {}),
      void 0 === IOLHP.profiling && (IOLHP.profiling = {}),
      void 0 === IOLHP.profiling.data)
    ) {
      IOLHP.profiling.data = null;
      var o = null;
      void 0 === IOLHP.profiling.callbacks && (IOLHP.profiling.callbacks = []);
      var n = function () {
        if (
          null !== IOL.cmp.both &&
          null !== o &&
          null === IOLHP.profiling.data
        ) {
          IOL.cmp.both
            ? (IOLHP.profiling.data = o)
            : (IOLHP.profiling.data = []),
            console.log(
              "*** PROFILING CALLBACK",
              IOLHP.profiling.data,
              IOL.cmp.both,
              IOLHP.profiling.callbacks.length
            );
          for (var e = 0; e < IOLHP.profiling.callbacks.length; e++)
            IOLHP.profiling.callbacks[e](IOLHP.profiling.data);
          IOLHP.profiling.callbacks.push = function (e) {
            e(IOLHP.profiling.data);
          };
        }
      };
      (e.iol_profiling_cbk = function (e) {
        (o = e), n();
      }),
        IOL.cmp.callbacks.push(n);
    }
  })(window);
var mustHaveATFStatus = !1;
function mustHaveATF() {
  var e;
  if (!mustHaveATFStatus)
    if (
      ((mustHaveATFStatus = !0),
      ((e = document.createElement("script")).src =
        _PUB_PATH +
        "/common/superheader_scripts.min.js?" +
        _SUPERHEADER_NOCACHE),
      document.getElementsByTagName("body")[0].appendChild(e),
      ((e = document.createElement("script")).src =
        _PUB_PATH + "../js/iol_evnt_v2b.min.js"),
      document.getElementsByTagName("body")[0].appendChild(e),
      (e.onload = function () {
        window.IOL &&
          window.IOL.EVNT &&
          window.IOL.EVNT.evMngrCls &&
          ((window.IOL = window.IOL || {}),
          (window.IOL.evMngr =
            window.IOL.evMngr || new window.IOL.EVNT.evMngrCls()),
          (window.IOL.superheader_clk_params = window.IOL
            .superheader_clk_params || {
            domain: window.location.hostname,
            superheader_ver: "1",
            area: "superheader",
          }),
          (window.IOL.footer_clk_params = window.IOL.footer_clk_params || {
            domain: window.location.hostname,
            footer_ver: "1",
            area: "footer",
          }),
          trackPerfContent20());
      }),
      isIeLt10)
    )
      ((e = document.createElement("script")).src =
        _PUB_PATH + "/js/hp.ie.min.js?" + _HPJS_NOCACHE),
        document.getElementsByTagName("body")[0].appendChild(e);
    else if (
      (((e = document.createElement("script")).src =
        _PUB_PATH + "/js/hp.min.js?" + _HPJS_NOCACHE),
      document.getElementsByTagName("body")[0].appendChild(e),
      "undefined" == typeof _CUSTOMIZATION && (_CUSTOMIZATION = 0),
      0 === _CUSTOMIZATION)
    )
      setTimeout(function () {
        var e = document.createElement("script");
        (e.src = _PUB_PATH + "/js/customize.min.js?_" + _HPJS_NOCACHE),
          document.getElementsByTagName("body")[0].appendChild(e);
      }, 3e3);
    else {
      var o = document.createElement("script");
      (o.src = _PUB_PATH + "/js/customize.min.js?_" + _HPJS_NOCACHE),
        document.getElementsByTagName("body")[0].appendChild(o);
    }
}
var scriptsToBeDelayedStatus = !1;
function scriptsToBeDelayed() {
  scriptsToBeDelayedStatus ||
    ((scriptsToBeDelayedStatus = !0),
    setTimeout(function () {
      if (_OPT_NLSN) {
        var e = document.createElement("script");
        (e.src = "//secure-it.imrworldwide.com/v60.js"),
          document.getElementsByTagName("body")[0].appendChild(e),
          (e.onload = function () {
            nol_t(
              { cid: "matrix-it", content: "0", server: "secure-it" },
              { check_cookie: 0 }
            )
              .record()
              .post();
          });
      }
      if (Math.random() < 0.1) {
        var o = document.createElement("script");
        o.setAttribute("async", ""),
          (o.src = "//www.googletagmanager.com/gtag/js?id=G-WKGZWBS7EY"),
          document.getElementsByTagName("body")[0].appendChild(o),
          (o.onload = function () {
            function e() {
              dataLayer.push(arguments);
            }
            (window.dataLayer = window.dataLayer || []),
              e("js", new Date()),
              e("config", "G-WKGZWBS7EY", { anonymize_ip: !0 });
          });
      }
      setTimeout(function () {
        for (var e = 0; e < performanceLog.length; e++) {
          var o = performanceLog[e];
          "" != o.msg && window.IOLMetricsTrack(o.msg, o.value);
        }
        navigator &&
          navigator.connection &&
          window.IOLMetricsTrack(
            "test_netpeed_kbs_hp",
            1e3 * navigator.connection.downlink
          );
      }, 1e3);
    }, 1e3));
}
if (
  ($(window).on("scroll", function (e) {
    (mustHaveATFStatus && scriptsToBeDelayedStatus) ||
      (mustHaveATF(), scriptsToBeDelayed());
  }),
  !isSetNoadv2501 && (trackADVPerformance(), mustHaveATF(), !isMobile))
) {
  var se2 = document.createElement("script");
  (se2.src = "//static.criteo.net/js/ld/publishertag.js"),
    document.getElementsByTagName("body")[0].appendChild(se2),
    (se2.onload = function () {
      Criteo.DisplayAcceptableAdIfAdblocked({
        zoneid: 352491,
        containerid: "admputop",
        ct0: "#CLICK_URL_UNESC#",
        collapseContainerIfNotAdblocked: !1,
        callIfNotAdBlocked: function () {
          googletag.cmd.push(function () {
            googletag.display("admputop");
          });
        },
      }),
        Criteo.DisplayAcceptableAdIfAdblocked({
          zoneid: 383918,
          containerid: "admpumiddle",
          ct0: "#CLICK_URL_UNESC#",
          collapseContainerIfNotAdblocked: !1,
          callIfNotAdBlocked: function () {
            googletag.cmd.push(function () {
              googletag.display("admpumiddle");
            });
          },
        });
    });
}
"undefined" != typeof _JS_TIMEOUT && setTimeout(mustHaveATF, _JS_TIMEOUT),
  "undefined" != typeof _JS_TIMEOUT &&
    setTimeout(scriptsToBeDelayed, _JS_TIMEOUT),
  (isMobile || isTablet) && fallbackNative();
var _notifications_conf = {
  sample: 30,
  daysOfSilence: 5,
  appid: "05519dd7-eee8-4330-a31b-eb21d95731a3",
  tagsFunction: function () {
    var e = {},
      o = "desktop";
    try {
      isTablet ? (o = "tablet") : isSmartphone && (o = "smartphone");
    } catch (e) {}
    e.device = o;
    var n = !1,
      t = !1,
      i = !1;
    try {
      (i = window.IOL.adv.getProfile("gender")) && (n = i.gender),
        (i = window.IOL.adv.getProfile("age")) && (t = i.age);
    } catch (e) {}
    return n && (e.gender = n), t && (e.age = t), e;
  },
  bi: {
    dom: "wwwtest.virgilio.it",
    ref_host: "www.virgilio.it",
    ref_path: "/",
    site: "hpvirgilio",
    res: 1192,
  },
};
-1 != window.location.href.indexOf("hpdev.") &&
  (_notifications_conf.appid = "9678221c-213e-4b54-b7d8-8e7af8b86938");
var _notifications = new (function () {
  var e = this;
  (this.popup = !1),
    (this.conf = {
      sample: 0,
      daysOfSilence: 5,
      tags: {},
      appid: "9678221c-213e-4b54-b7d8-8e7af8b86938",
      tagsFunction: !1,
      welcome: {
        disable: !1,
        title: "Grazie per esserti iscritto",
        message: "Lo staff di Virgilio",
      },
      clickHide: !0,
      bxmp: "https://evnt.iol.it/v2?&bxmp=[DOM]%2C%2C[REF_HOST]%2C[REF_PATH]%2C[SITE]-push-dialog%2C[SITE]%253Bpush-dialog%253Bopenpopup%2C[RES]%2C&nc=[RND]",
      ck: "https://evnt.iol.it/v2?&ck=[DOM]%2C%2C[REF_HOST]%2C[REF_PATH]%2C[SITE]-push-dialog-[KEY]%2C%2C[SITE]%2Cpushdialog%2C[KEY]%2C%2C%2C%2C%2C[RES]%2C%2C0&nc=[RND]",
      bi: !1,
    }),
    (this.safe = !1);
  var o = !1;
  (this.getCookie = function (e) {
    var o = document.cookie.match("(^|;) ?" + e + "=([^;]*)(;|$)");
    return o ? o[2] : null;
  }),
    (this.setCookie = function (e, o, n) {
      var t = new Date();
      t.setTime(t.getTime() + 864e5 * n),
        (document.cookie = e + "=" + o + ";path=/;expires=" + t.toGMTString());
    }),
    (this.deleteCookie = function (o) {
      e.setCookie(o, "", -1);
    }),
    (this.init = function () {
      this.parseConf();
      var o = 0;
      if (
        ((o = e.getCookie("_prenotify_rnd")) ||
          ((o = Math.floor(100 * Math.random() + 1)),
          e.setCookie("_prenotify_rnd", o, 365)),
        !(Number(o) > this.conf.sample))
      ) {
        var n = document.createElement("script");
        n.setAttribute("async", ""),
          (n.src = "https://cdn.onesignal.com/sdks/OneSignalSDK.js"),
          document.getElementsByTagName("body")[0].appendChild(n),
          (window.OneSignal = window.OneSignal || []),
          OneSignal.push(function () {
            OneSignal.isPushNotificationsSupported() &&
              (console.log("*** OS SUPPORT"),
              OneSignal.init({
                appId: e.conf.appid,
                autoRegister: !1,
                notifyButton: { enable: !1 },
                welcomeNotification: e.conf.welcome,
                requiresUserPrivacyConsent: !0,
              }));
          }),
          "function" == typeof this.conf.tagsFunction &&
            (this.conf.tags = this.conf.tagsFunction()),
          IOL.cmp.callbacks.push(function (o) {
            setTimeout(function () {
              OneSignal.push(function () {
                OneSignal.provideUserConsent(o),
                  console.log("*** OS CONS", o),
                  o &&
                    (OneSignal.getNotificationPermission(function (o) {
                      console.log("*** OS GNP"),
                        "default" === o
                          ? e.defaultStatus()
                          : "granted" === o && e.setTags();
                    }),
                    OneSignal.on("subscriptionChange", function (o) {
                      console.log("*** OS CHANGE"), e.change(o);
                    }));
              });
            }, 500);
          });
      }
    }),
    (this.defaultStatus = function () {
      e.deleteCookie("_prenotify_data"),
        e.getCookie("_prenotify") ||
          (e.open(),
          e.conf.clickHide &&
            window.addEventListener &&
            window.addEventListener("click", function () {
              e.safe || e.notNow();
            }));
    }),
    (this.change = function (o) {
      o && e.setTags(!0);
    }),
    (this.notNow = function (o) {
      e.popup &&
        (o && (e._(), e.sendBi("ck", "notnow")),
        e.setCookie("_prenotify", 1, e.conf.daysOfSilence),
        e.close(),
        e.conf.clickHide &&
          window.addEventListener &&
          window.removeEventListener("click", function () {
            e.safe || e.notNow();
          }));
    }),
    (this.closeD = function (o) {
      o && (e._(), e.sendBi("ck", "closepopup")), e.notNow();
    }),
    (this._ = function () {
      (e.safe = !0),
        o && clearTimeout(o),
        (o = setTimeout(function () {
          e.safe = !1;
        }, 500));
    }),
    (this.activate = function (o) {
      o && (e._(), e.sendBi("ck", "agree")),
        OneSignal.registerForPushNotifications(),
        e.close();
    }),
    (this.open = function () {
      (e.popup = !0),
        (document.body.className = document.body.className + " preNotify"),
        e.sendBi("bxmp");
    }),
    (this.close = function () {
      (e.popup = !1),
        (document.body.className = document.body.className.replace(
          " preNotify",
          ""
        ));
    }),
    (this.setTags = function (o) {
      if (
        (void 0 === o && (o = !1),
        !1 !== e.conf.tags && !e.isEmpty(e.conf.tags))
      ) {
        var n = e.getCookie("_prenotify_data");
        n = n ? Number(n) : 0;
        var t = e.countProp(e.conf.tags);
        if (t <= n) return;
        console.log("UPDATEDTAGS " + t),
          OneSignal.sendTags(e.conf.tags, function (n) {
            o || e.setCookie("_prenotify_data", t, 365);
          });
      }
    }),
    (this.sendBi = function (o, n) {
      if (e.conf.bi) {
        void 0 === o && (o = "bxmp"), void 0 === n && (n = "");
        var t = new Date(),
          i = e.conf.bxmp;
        "ck" == o && (i = e.conf.ck),
          (i = (i = (i = (i = (i = (i = (i = i.replace(
            /\[DOM\]/g,
            e.conf.bi.dom
          )).replace(/\[REF_HOST\]/g, e.conf.bi.ref_host)).replace(
            /\[REF_PATH\]/g,
            e.conf.bi.ref_path
          )).replace(/\[SITE\]/g, e.conf.bi.site)).replace(
            /\[RES\]/g,
            e.conf.bi.res
          )).replace(/\[RND\]/g, t.getTime())).replace(/\[KEY\]/g, n)),
          (new Image().src = i);
      }
    }),
    (this.sendClick = function () {}),
    (this.parseConf = function () {
      void 0 !== _notifications_conf &&
        (void 0 !== _notifications_conf.sample &&
          (this.conf.sample = _notifications_conf.sample),
        _notifications_conf.daysOfSilence &&
          (this.conf.daysOfSilence = _notifications_conf.daysOfSilence),
        _notifications_conf.tags && (this.conf.tags = _notifications_conf.tags),
        _notifications_conf.tagsFunction &&
          (this.conf.tagsFunction = _notifications_conf.tagsFunction),
        _notifications_conf.appid &&
          (this.conf.appid = _notifications_conf.appid),
        _notifications_conf.welcome &&
          (this.conf.welcome = _notifications_conf.welcome),
        _notifications_conf.clickHide &&
          (this.conf.clickHide = _notifications_conf.clickHide),
        _notifications_conf.bi && (this.conf.bi = _notifications_conf.bi));
    }),
    (this.isEmpty = function (e) {
      for (var o in e) if (e.hasOwnProperty(o)) return !1;
      return JSON.stringify(e) === JSON.stringify({});
    }),
    (this.countProp = function (e) {
      var o = 0;
      for (var n in e) o++;
      return o;
    });
})();
_notifications.init();
